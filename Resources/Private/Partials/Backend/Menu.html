{namespace neos=TYPO3\Neos\ViewHelpers}
<noscript>
	<div id="neos-menu-panel" class="neos-noscript">
		<div class="neos-menu-section">
			<f:link.action package="TYPO3.Neos" controller="Backend\Backend" action="index" title="Content view" class="neos-menu-headline active">
				<i class="icon-file"></i> Content
			</f:link.action>
			<f:if condition="{sites}">
				<div class="neos-menu-list">
					<f:for each="{sites}" as="site">
						<neos:link.node node="{site.siteNode}" title="{site.nodeName}" class="{f:if(condition: site.active, then: 'active')}">
							<i class="icon-globe"></i> {site.name}
						</neos:link.node>
					</f:for>
				</div>
			</f:if>
		</div>
		<f:for each="{modules}" as="module" key="path">
			<f:if condition="{module.hideInMenu}">
				<f:then></f:then>
				<f:else>
					<f:if condition="{module.role}">
						<f:then>
							<f:security.ifHasRole role="{module.role}">
								<f:render section="moduleMenu" arguments="{_all}" />
							</f:security.ifHasRole>
						</f:then>
						<f:else>
							<f:render section="moduleMenu" arguments="{_all}" />
						</f:else>
					</f:if>
				</f:else>
			</f:if>
		</f:for>
	</div>
</noscript>

<f:section name="moduleMenu">
	<div class="neos-menu-section">
		<neos:link.module path="{path}" class="neos-menu-headline{f:if(condition: '{path} == {modulePath}', then: ' active')}">
			<i class="{f:if(condition: module.icon, then: module.icon, else: 'icon-puzzle-piece')}"></i>
			{module.label}
		</neos:link.module>
		<f:if condition="{module.submodules}">
			<div class="neos-menu-list">
				<f:for each="{module.submodules}" as="submodule" key="subpath">
					<neos:link.module path="{path}/{subpath}" class="neos-menu-headline{f:if(condition: '{0: \'{path}/{subpath}\'} == {0: \'{modulePath}\'}', then: ' active')}">
						<i class="{f:if(condition: submodule.icon, then: submodule.icon, else: 'icon-puzzle-piece')}"></i>
						{submodule.label}
					</neos:link.module>
				</f:for>
			</div>
		</f:if>
	</div>
</f:section>